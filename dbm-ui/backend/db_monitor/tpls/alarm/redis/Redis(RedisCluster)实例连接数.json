{
  "version": "v2",
  "bk_biz_id": 5005578,
  "name": "Redis(RedisCluster)实例连接数",
  "source": "bkmonitorv3",
  "scenario": "component",
  "type": "monitor",
  "items": [
    {
      "id": 105798,
      "name": "[RedisCluster]实例连接数",
      "no_data_config": {
        "level": 2,
        "continuous": 10,
        "is_enabled": false,
        "agg_dimension": []
      },
      "target": [
        []
      ],
      "expression": "a",
      "functions": [],
      "origin_sql": "max by (app,cluster_domain,bk_target_ip,instance_role,cluster_type,instance,bk_target_cloud_id,appid,bk_target_service_instance_id) (bkmonitor:exporter_dbm_predixy_exporter:predixy_cluster_connections{cluster_type=\"PredixyRedisCluster\"})",
      "query_configs": [
        {
          "data_source_label": "prometheus",
          "data_type_label": "time_series",
          "alias": "a",
          "metric_id": "",
          "id": 110265,
          "functions": [],
          "promql": "max by (app,cluster_domain,bk_target_ip,instance_role,cluster_type,instance,bk_target_cloud_id,appid,bk_target_service_instance_id) (bkmonitor:exporter_dbm_predixy_exporter:predixy_cluster_connections{cluster_type=\"PredixyRedisCluster\"})",
          "agg_interval": 60
        }
      ],
      "algorithms": [
        {
          "id": 112110,
          "type": "Threshold",
          "level": 2,
          "config": [
            [
              {
                "method": "gte",
                "threshold": 12000
              }
            ]
          ],
          "unit_prefix": ""
        }
      ],
      "metric_type": "time_series"
    }
  ],
  "detects": [
    {
      "id": 110025,
      "level": 1,
      "expression": "",
      "trigger_config": {
        "count": 2,
        "uptime": {
          "calendars": [],
          "time_ranges": [
            {
              "end": "23:59",
              "start": "00:00"
            }
          ]
        },
        "check_window": 5
      },
      "recovery_config": {
        "check_window": 5,
        "status_setter": "recovery"
      },
      "connector": "and"
    },
    {
      "id": 110026,
      "level": 2,
      "expression": "",
      "trigger_config": {
        "count": 2,
        "uptime": {
          "calendars": [],
          "time_ranges": [
            {
              "end": "23:59",
              "start": "00:00"
            }
          ]
        },
        "check_window": 5
      },
      "recovery_config": {
        "check_window": 5,
        "status_setter": "recovery"
      },
      "connector": "and"
    }
  ],
  "actions": [],
  "notice": {
    "id": 125194,
    "config_id": 102863,
    "user_groups": [],
    "signal": [
      "no_data",
      "abnormal"
    ],
    "options": {
      "end_time": "23:59:59",
      "start_time": "00:00:00",
      "assign_mode": [
        "by_rule"
      ],
      "upgrade_config": {
        "is_enabled": false,
        "user_groups": [],
        "upgrade_interval": 1440
      },
      "converge_config": {
        "count": 1,
        "condition": [
          {
            "dimension": "strategy_id",
            "value": [
              "self"
            ]
          },
          {
            "dimension": "dimensions",
            "value": [
              "self"
            ]
          },
          {
            "dimension": "alert_level",
            "value": [
              "self"
            ]
          },
          {
            "dimension": "signal",
            "value": [
              "self"
            ]
          },
          {
            "dimension": "bk_biz_id",
            "value": [
              "self"
            ]
          },
          {
            "dimension": "notice_receiver",
            "value": [
              "self"
            ]
          },
          {
            "dimension": "notice_way",
            "value": [
              "self"
            ]
          }
        ],
        "timedelta": 60,
        "is_enabled": true,
        "converge_func": "collect",
        "need_biz_converge": true,
        "sub_converge_config": {
          "timedelta": 60,
          "count": 2,
          "condition": [
            {
              "dimension": "bk_biz_id",
              "value": [
                "self"
              ]
            },
            {
              "dimension": "notice_receiver",
              "value": [
                "self"
              ]
            },
            {
              "dimension": "notice_way",
              "value": [
                "self"
              ]
            },
            {
              "dimension": "alert_level",
              "value": [
                "self"
              ]
            },
            {
              "dimension": "signal",
              "value": [
                "self"
              ]
            }
          ],
          "converge_func": "collect_alarm"
        }
      },
      "chart_image_enabled": true,
      "exclude_notice_ways": {
        "ack": [],
        "closed": [],
        "recovered": []
      },
      "noise_reduce_config": {
        "unit": "percent",
        "count": 10,
        "timedelta": 5,
        "dimensions": [
          "bk_target_ip"
        ],
        "is_enabled": false
      }
    },
    "relate_type": "NOTICE",
    "config": {
      "need_poll": true,
      "notify_interval": 1800,
      "interval_notify_mode": "standard",
      "template": [
        {
          "signal": "abnormal",
          "message_tmpl": "{{content.level}}\n{{content.begin_time}}\n{{content.time}}\n{{content.duration}}\n{{content.target_type}}\n{{content.data_source}}\n{{content.content}}\n{{content.current_value}}\n{{content.biz}}\n{{content.target}}\n{{content.dimension}}\n{{content.detail}}\n{{content.related_info}}",
          "title_tmpl": "{{business.bk_biz_name}} - {{alarm.name}}{{alarm.display_type}}"
        },
        {
          "signal": "recovered",
          "message_tmpl": "{{content.level}}\n{{content.begin_time}}\n{{content.time}}\n{{content.duration}}\n{{content.target_type}}\n{{content.data_source}}\n{{content.content}}\n{{content.current_value}}\n{{content.biz}}\n{{content.target}}\n{{content.dimension}}\n{{content.detail}}\n{{content.related_info}}",
          "title_tmpl": "{{business.bk_biz_name}} - {{alarm.name}}{{alarm.display_type}}"
        },
        {
          "signal": "closed",
          "message_tmpl": "{{content.level}}\n{{content.begin_time}}\n{{content.time}}\n{{content.duration}}\n{{content.target_type}}\n{{content.data_source}}\n{{content.content}}\n{{content.current_value}}\n{{content.biz}}\n{{content.target}}\n{{content.dimension}}\n{{content.detail}}\n{{content.related_info}}",
          "title_tmpl": "{{business.bk_biz_name}} - {{alarm.name}}{{alarm.display_type}}"
        }
      ]
    },
    "user_group_list": []
  },
  "is_enabled": true,
  "is_invalid": false,
  "invalid_type": "",
  "update_time": "2023-11-30 16:23:59+0800",
  "update_user": "admin",
  "create_time": "2023-11-30 16:23:59+0800",
  "create_user": "admin",
  "labels": [
    "DBM_REDIS"
  ],
  "app": "",
  "path": "",
  "priority": null,
  "priority_group_key": "",
  "metric_type": "time_series",
  "config_source": "UI",
  "alert_count": 0,
  "shield_alert_count": 0,
  "shield_info": {
    "is_shielded": false,
    "shield_ids": []
  },
  "add_allowed": false,
  "data_source_type": [
    "P",
    "r",
    "o",
    "m",
    "e",
    "t",
    "h",
    "e",
    "u",
    "s"
  ]
}